!function(t){var i=[],e="dirty",n="clean",s="dirtyInitialValue",r=function(t){var e;return i.forEach(function(i){i.id===t&&(e=i)}),e},a=function(i){i.form.on("submit",function(){i.submitting=!0}),i.options.preventLeaving&&t(window).on("beforeunload",function(t){if(i.isDirty&&!i.submitting)return t.preventDefault(),i.options.leavingMessage})},o=function(t){t.form.find("input, select, textarea").on("change.dirty click.dirty keyup.dirty keydown.dirty blur.dirty",function(i){t.checkValues(i)}),t.form.on("dirty",function(){"function"==typeof t.options.onDirty&&t.options.onDirty()}),t.form.on("clean",function(){"function"==typeof t.options.onClean&&t.options.onClean()})},c=function(t){t.form.find("input, select, textarea").off("change.dirty click.dirty keyup.dirty keydown.dirty blur.dirty"),t.form.off("dirty"),t.form.off("clean")},f=function(e,s){this.form=e,this.isDirty=!1,this.options=s,this.history=[n,n],this.id=t(e).attr("id"),i.push(this)};f.prototype={init:function(){this.saveInitialValues(),this.setEvents()},isRadioOrCheckbox:function(i){return t(i).is(":radio, :checkbox")},isFileInput:function(i){return t(i).is(":file")},saveInitialValues:function(){var i=this;this.form.find("input, select, textarea").each(function(e,n){var r=i.isRadioOrCheckbox(n),a=i.isFileInput(n);if(r){var o=t(n).is(":checked")?"checked":"unchecked";t(n).data(s,o)}else a?t(n).data(s,JSON.stringify(n.files)):t(n).data(s,t(n).val()||"")})},refreshEvents:function(){c(this),o(this)},showDirtyFields:function(){return this.form.find("input, select, textarea").filter(function(i,e){return t(e).data("isDirty")})},setEvents:function(){a(this),o(this)},isFieldDirty:function(t){var i=t.data(s);null==i&&(i="");var e=t.val();null==e&&(e="");var n=/^(true|false)$/i;return n.test(i)&&n.test(e)?!RegExp("^"+i+"$","i").test(e):e!==i},isFileInputDirty:function(t){var i=t.data(s);return JSON.stringify(t[0].files)!==i},isCheckboxDirty:function(t){var i;return t.data(s)!==(t.is(":checked")?"checked":"unchecked")},checkValues:function(i){var e=this,n=!1;this.form.find("input, select, textarea").each(function(i,s){var r,a=e.isRadioOrCheckbox(s),o=e.isFileInput(s),c=t(s);r=a?e.isCheckboxDirty(c):o?e.isFileInputDirty(c):e.isFieldDirty(c),c.data("isDirty",r),n|=r}),n?e.setDirty():e.setClean()},setDirty:function(){this.isDirty=!0,this.history[0]=this.history[1],this.history[1]=e,(this.options.fireEventsOnEachChange||this.wasJustClean())&&this.form.trigger("dirty")},setClean:function(){this.isDirty=!1,this.history[0]=this.history[1],this.history[1]=n,(this.options.fireEventsOnEachChange||this.wasJustDirty())&&this.form.trigger("clean")},wasJustDirty:function(){return this.history[0]===e},wasJustClean:function(){return this.history[0]===n},setAsClean:function(){this.saveInitialValues(),this.setClean()},setAsDirty:function(){this.saveInitialValues(),this.setDirty()},resetForm:function(){var i=this;this.form.find("input, select, textarea").each(function(e,n){var r=t(n),a=i.isRadioOrCheckbox(n),o=i.isFileInput(n);if(a){var c=r.data(s);r.prop("checked","checked"===c)}if(o)n.value="",t(n).data(s,JSON.stringify(n.files));else{var f=r.data(s);r.val(f)}}),this.checkValues()}},t.fn.dirty=function(i){if("string"==typeof i&&/^(isDirty|isClean|refreshEvents|resetForm|setAsClean|setAsDirty|showDirtyFields)$/i.test(i)){var e=r(t(this).attr("id"));e||(e=new f(t(this),i)).init();var n=i.toLowerCase();switch(n){case"isclean":return!e.isDirty;case"isdirty":return e.isDirty;case"refreshevents":e.refreshEvents();case"resetform":e.resetForm();case"setasclean":return e.setAsClean();case"setasdirty":return e.setAsDirty();case"showdirtyfields":return e.showDirtyFields()}}else if("object"==typeof i||!i)return this.each(function(e,n){i=t.extend({},t.fn.dirty.defaults,i),new f(t(n),i).init()})},t.fn.dirty.defaults={preventLeaving:!1,leavingMessage:"There are unsaved changes on this page which will be discarded if you continue.",onDirty:t.noop,onClean:t.noop,fireEventsOnEachChange:!1}}(jQuery);